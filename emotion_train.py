# ==========================================================
# ğŸ­ ê°ì • ë¶„ì„ ëª¨ë¸ (ëŒ€í‘œê°ì • + ì„¸ë¶€ê°ì •) í•™ìŠµ ì½”ë“œ
# ==========================================================
# ì´ ì½”ë“œëŠ” ë‘ ê°œì˜ ëª¨ë¸ì„ í•™ìŠµí•¨:
# â‘  ëŒ€í‘œê°ì • ëª¨ë¸ (ex. í–‰ë³µ, ìŠ¬í””, ë¶„ë…¸ ë“±)
# â‘¡ ì„¸ë¶€ê°ì • ëª¨ë¸ (ex. í™”ë‚¨, ì§œì¦ë‚¨, ìŠ¬í””, ì™¸ë¡œì›€ ë“±)
# ê°ì •ì‚¬ì „(emotion_dictionary.csv)ì„ í™œìš©í•˜ì—¬ ë¬¸ì¥ ì•ˆì˜ ê°ì • ë‹¨ì–´ë¥¼ ë°˜ì˜í•¨
# ==========================================================

# ----------------------------------------------------------
# ğŸ“¦ 1. í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸°
# ----------------------------------------------------------
import pandas as pd                           # ë°ì´í„°í”„ë ˆì„ í˜•íƒœë¡œ ë°ì´í„° ë‹¤ë£¨ê¸°
from sklearn.model_selection import train_test_split  # í•™ìŠµìš©/ê²€ì¦ìš© ë°ì´í„° ë¶„ë¦¬
from sklearn.feature_extraction.text import TfidfVectorizer  # ë¬¸ì¥ì„ ìˆ«ì ë²¡í„°ë¡œ ë³€í™˜
from sklearn.ensemble import ExtraTreesClassifier     # íŠ¸ë¦¬ ê¸°ë°˜ ë¶„ë¥˜ ëª¨ë¸
from sklearn.metrics import accuracy_score, classification_report  # ì •í™•ë„/ë¦¬í¬íŠ¸ í‰ê°€
import pickle                               # ëª¨ë¸ ì €ì¥ìš©
import re                                   # í…ìŠ¤íŠ¸ ì „ì²˜ë¦¬ìš© ì •ê·œì‹

# ----------------------------------------------------------
# ğŸ§¹ 2. ë¶ˆìš©ì–´ ë¦¬ìŠ¤íŠ¸ (ê°ì • ë¶„ì„ì— ë¶ˆí•„ìš”í•œ ë‹¨ì–´ë“¤)
# ----------------------------------------------------------
stopwords = [
    "ì€","ëŠ”","ì´","ê°€","ì„","ë¥¼","ì—","ì—ì„œ","ì—ê²Œ","ê»˜","í•œ","í•˜ë‹¤",
    "ê·¸ë¦¬ê³ ","ê·¸ë˜ì„œ","ê·¸ëŸ¬ë‚˜","í•˜ì§€ë§Œ","ë˜í•œ","ë•Œë¬¸ì—","ë„ˆë¬´","ì •ë§",
    "ê·¸ëƒ¥","ì¡°ê¸ˆ","ì¢€","ë˜","ë˜ëŠ”","ì´ë‚˜","ê±°ë‚˜","ì €ëŠ”","ë‚˜ëŠ”","ë‚´ê°€",
    "ìš°ë¦¬","ë„ˆ","ë‹ˆ","ê·¸","ê·¸ë…€","ì´ê²ƒ","ì €ê²ƒ","ê±°","ê²Œ","ê±¸","ê²ƒ"
]

# ----------------------------------------------------------
# âœ¨ 3. í…ìŠ¤íŠ¸ ì „ì²˜ë¦¬ í•¨ìˆ˜ ì •ì˜
# ----------------------------------------------------------
def clean_text(text):
    # â‘  ë¬¸ì¥ì—ì„œ í•œê¸€ê³¼ ê³µë°±ì„ ì œì™¸í•œ ëª¨ë“  ë¬¸ì ì œê±°
    text = re.sub(r"[^ã„±-ã…ã…-ã…£ê°€-í£\s]", " ", str(text))
    # â‘¡ ë¶ˆìš©ì–´ ë¦¬ìŠ¤íŠ¸ì˜ ë‹¨ì–´ ì œê±°
    for sw in stopwords:
        text = text.replace(sw, " ")
    # â‘¢ ë¶ˆí•„ìš”í•œ ê³µë°± ì •ë¦¬ (ì—°ì†ëœ ê³µë°±ì„ í•˜ë‚˜ë¡œ)
    text = re.sub(r"\s+", " ", text).strip()
    return text

# ----------------------------------------------------------
# ğŸ“‚ 4. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
# ----------------------------------------------------------
# ê°ì • ëŒ€í™” ë°ì´í„°ì™€ ê°ì •ì‚¬ì „(ë‹¨ì–´ ê¸°ë°˜ ê°ì • ë§¤í•‘)ì„ ë¶ˆëŸ¬ì˜´
df = pd.read_csv(r"C:\ai-project\moody-movie\data\emotion_data.csv", encoding="utf-8-sig")
dict_df = pd.read_csv(r"C:\ai-project\moody-movie\data\emotion_dictionary.csv", encoding="utf-8-sig")

# ë°ì´í„°í”„ë ˆì„ì— ì»¬ëŸ¼ëª…ì´ ì¤‘ë³µìœ¼ë¡œ ë“¤ì–´ê°„ ê²½ìš°(ì—‘ì…€ ì €ì¥ ì‹œ ìì£¼ ë°œìƒ) ì œê±°
df = df[df["ëŒ€í‘œê°ì •"] != "ëŒ€í‘œê°ì •"].reset_index(drop=True)

# ì „ì²˜ë¦¬ í•¨ìˆ˜(clean_text) ì ìš© â†’ í•œê¸€ë§Œ ë‚¨ê¸°ê³  ë¶ˆìš©ì–´ ì œê±°
df["ëŒ€í™”"] = df["ëŒ€í™”"].apply(clean_text)

# ----------------------------------------------------------
# ğŸ“˜ 5. ê°ì •ì‚¬ì „(ë‹¨ì–´-ê°ì • ë§¤í•‘) ë”•ì…”ë„ˆë¦¬í™”
# ----------------------------------------------------------
emotion_dict = {}
for _, row in dict_df.iterrows():
    emotion = row["ê°ì •"]           # ê°ì • ì´ë¦„ (ì˜ˆ: í–‰ë³µ, ìŠ¬í”” ë“±)
    word = str(row["ë‹¨ì–´"]).strip() # ê°ì • ë‹¨ì–´ (ì˜ˆ: ê¸°ì˜ë‹¤, ì™¸ë¡­ë‹¤ ë“±)
    if word:
        emotion_dict.setdefault(emotion, []).append(word)

# ----------------------------------------------------------
# ğŸ’¡ 6. ê°ì •ì‚¬ì „ ë‹¨ì–´ì™€ ë¬¸ì¥ ë§¤ì¹­ í•¨ìˆ˜
# ----------------------------------------------------------
def match_emotion(text):
    if pd.isna(text):  # ê²°ì¸¡ê°’(ë¹ˆì¹¸)ì´ë©´ None ë°˜í™˜
        return None

    text = str(text)
    found = []  # ë§¤ì¹­ëœ ê°ì • ë¦¬ìŠ¤íŠ¸

    # ì‚¬ì „ì˜ ê° ê°ì •ì— ëŒ€í•´ ë‹¨ì–´ê°€ ë¬¸ì¥ì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
    for emotion, words in emotion_dict.items():
        for w in words:
            if w in text:
                found.append(emotion)

    # ì—¬ëŸ¬ ê°ì •ì´ ë§¤ì¹­ë  ê²½ìš°, ê°€ì¥ ë§ì´ ë“±ì¥í•œ ê°ì •ì„ ë°˜í™˜
    if found:
        return max(set(found), key=found.count)
    return None

# ë¬¸ì¥ë³„ë¡œ ê°ì •ì‚¬ì „ ê¸°ë°˜ ê°ì • ì¶”ì¶œ
df["ì‚¬ì „ê°ì •"] = df["ëŒ€í™”"].apply(match_emotion)

# ê¸°ì¡´ ëŒ€í‘œê°ì • ì»¬ëŸ¼ ìœ ì§€
df["ëŒ€í‘œê°ì •"] = df["ëŒ€í‘œê°ì •"]

# ----------------------------------------------------------
# ğŸ§  7. ì‚¬ì „ê°ì •ì„ ë¬¸ì¥ì— ì¶”ê°€í•˜ì—¬ ì…ë ¥ ë°ì´í„° êµ¬ì„±
# ----------------------------------------------------------
# ì˜ˆ: "(ì°¸ê³ ê°ì •:ìŠ¬í””) ì˜¤ëŠ˜ ë„ˆë¬´ í˜ë“¤ì—ˆì–´" ì™€ ê°™ì€ ì‹ìœ¼ë¡œ ë¬¸ì¥ ë³´ê°•
df["ì…ë ¥ë¬¸ì¥"] = df.apply(
    lambda r: f"(ì°¸ê³ ê°ì •:{r['ì‚¬ì „ê°ì •']}) {r['ëŒ€í™”']}"
    if pd.notna(r["ì‚¬ì „ê°ì •"]) else r["ëŒ€í™”"],
    axis=1
)

# ëª¨ë¸ í•™ìŠµ ì‹œì—ë„ ì‚¬ì „ê°ì •ì„ ë¬¸ì¥ ëì— ë¶™ì—¬ì¤Œ (ë¬¸ì¥ ë‚´ì— ë°˜ì˜ë˜ë„ë¡)
df["ì…ë ¥ë¬¸ì¥"] = df.apply(
    lambda r: f"{r['ëŒ€í™”']} {r['ì‚¬ì „ê°ì •']}" if pd.notna(r["ì‚¬ì „ê°ì •"]) else r["ëŒ€í™”"],
    axis=1
)

# ì…ë ¥(ë¬¸ì¥), ëŒ€í‘œê°ì • ë¼ë²¨, ì„¸ë¶€ê°ì • ë¼ë²¨ ë¶„ë¦¬
texts = df["ì…ë ¥ë¬¸ì¥"]
labels = df["ëŒ€í‘œê°ì •"]
sub_labels = df["ì„¸ë¶€ê°ì •"]

# ----------------------------------------------------------
# âš™ï¸ 8. ëŒ€í‘œê°ì • ëª¨ë¸ í•™ìŠµ
# ----------------------------------------------------------
print("\nëŒ€í‘œê°ì • ëª¨ë¸ í•™ìŠµ ì‹œì‘...")

# í•™ìŠµ/í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¶„ë¦¬ (stratifyëŠ” í´ë˜ìŠ¤ ë¹„ìœ¨ ìœ ì§€ìš©)
X_train, X_test, y_train, y_test = train_test_split(
    texts, labels, test_size=0.2, random_state=42, stratify=labels
)

# TF-IDF ë²¡í„°í™” (ë¬¸ì ë‹¨ìœ„ë¡œ 1~3ê¸€ì ì¡°í•©)
vectorizer = TfidfVectorizer(
    analyzer='char',
    ngram_range=(1, 3),
    max_features=8000,  # ë‹¨ì–´(ë¬¸ì) íŠ¹ì§• ìˆ˜ ì œí•œ
    min_df=2            # ìµœì†Œ 2íšŒ ì´ìƒ ë“±ì¥í•´ì•¼ ì‚¬ìš©
)

# ë²¡í„°í™” ì§„í–‰
X_train_tfidf = vectorizer.fit_transform(X_train)
X_test_tfidf = vectorizer.transform(X_test)

# ExtraTreesClassifier ëª¨ë¸ ìƒì„±
et_model = ExtraTreesClassifier(
    n_estimators=674,        # íŠ¸ë¦¬ ê°œìˆ˜ (í´ìˆ˜ë¡ ì•ˆì •ì )
    max_depth=None,          # íŠ¸ë¦¬ ê¹Šì´ ì œí•œ ì—†ìŒ
    min_samples_split=2,     # ë¶„í•  ìµœì†Œ ìƒ˜í”Œ ìˆ˜
    min_samples_leaf=1,      # ë¦¬í”„ ë…¸ë“œ ìµœì†Œ ìƒ˜í”Œ ìˆ˜
    max_features='log2',     # ì‚¬ìš©í•  íŠ¹ì§• ìˆ˜ ê¸°ì¤€
    class_weight='balanced', # ê°ì •ë³„ ë°ì´í„° ë¶ˆê· í˜• ë³´ì •
    n_jobs=-1,               # ëª¨ë“  CPU ì‚¬ìš©
    random_state=42,         # ì¬í˜„ ê°€ëŠ¥í•œ ê²°ê³¼
    verbose=1                # í•™ìŠµ ë¡œê·¸ ì¶œë ¥
)

# ëª¨ë¸ í•™ìŠµ ìˆ˜í–‰
et_model.fit(X_train_tfidf, y_train)

# ì˜ˆì¸¡ ê²°ê³¼ í™•ì¸
y_pred = et_model.predict(X_test_tfidf)

# ì„±ëŠ¥ í‰ê°€ ì¶œë ¥
main_acc = accuracy_score(y_test, y_pred)
print("\n[ëŒ€í‘œê°ì • ëª¨ë¸ ê²°ê³¼]")
print(f"Train Accuracy: {accuracy_score(y_train, et_model.predict(X_train_tfidf)):.4f}")
print(f"Test  Accuracy: {main_acc:.4f}")
print(classification_report(y_test, y_pred))
print("=" * 60)

# ëª¨ë¸ ë° ë²¡í„° ì €ì¥ (ë‚˜ì¤‘ì— Flaskì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸° ìš©)
pickle.dump(et_model, open("C:/ai-project/moody-movie/models/emotion_model.pkl", "wb"))
pickle.dump(vectorizer, open("C:/ai-project/moody-movie/models/vectorizer.pkl", "wb"))

# ----------------------------------------------------------
# ğŸ’« 9. ì„¸ë¶€ê°ì • ëª¨ë¸ í•™ìŠµ
# ----------------------------------------------------------
print("\nì„¸ë¶€ê°ì • ëª¨ë¸ í•™ìŠµ ì‹œì‘...")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§¹ (1) ë„ˆë¬´ ì ê²Œ ë“±ì¥í•œ ì„¸ë¶€ê°ì • ì œê±°
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ë°ì´í„°ì—ì„œ ì–´ë–¤ ì„¸ë¶€ê°ì •ì€ í•œë‘ ë²ˆë§Œ ë“±ì¥í•  ìˆ˜ë„ ìˆìŒ.
# ì´ëŸ° ê°ì •ì€ ëª¨ë¸ì´ ì œëŒ€ë¡œ í•™ìŠµí•˜ì§€ ëª»í•˜ë¯€ë¡œ ì œì™¸í•¨.
sub_label_counts = df["ì„¸ë¶€ê°ì •"].value_counts()   # ì„¸ë¶€ê°ì •ë³„ ë“±ì¥ íšŸìˆ˜ ê³„ì‚°
valid_sub_labels = sub_label_counts[sub_label_counts >= 2].index  # ìµœì†Œ 2íšŒ ì´ìƒ ë“±ì¥í•œ ê°ì •ë§Œ ë‚¨ê¹€
df_sub = df[df["ì„¸ë¶€ê°ì •"].isin(valid_sub_labels)]  # ìœ íš¨í•œ ì„¸ë¶€ê°ì •ë§Œ í•„í„°ë§í•œ ìƒˆë¡œìš´ ë°ì´í„°í”„ë ˆì„ ìƒì„±

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# âœ‚ï¸ (2) í•™ìŠµìš© / í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ë¶„ë¦¬
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì „ì²´ ë°ì´í„°ë¥¼ ëœë¤í•˜ê²Œ ë‚˜ëˆ„ì–´ 80%ëŠ” í•™ìŠµ, 20%ëŠ” í…ŒìŠ¤íŠ¸ë¡œ ì‚¬ìš©
X_train_sub, X_test_sub, y_train_sub, y_test_sub = train_test_split(
    df_sub["ì…ë ¥ë¬¸ì¥"],     # ì…ë ¥ ë°ì´í„° (ë¬¸ì¥)
    df_sub["ì„¸ë¶€ê°ì •"],     # ì¶œë ¥ ë°ì´í„° (ì„¸ë¶€ê°ì • ë ˆì´ë¸”)
    test_size=0.2,           # í…ŒìŠ¤íŠ¸ ë°ì´í„° ë¹„ìœ¨ = 20%
    random_state=42,         # ë¬´ì‘ìœ„ ì‹œë“œ ê³ ì • (ì¬í˜„ì„±)
    stratify=df_sub["ì„¸ë¶€ê°ì •"]  # ê°ì • ë¹„ìœ¨ì´ ìœ ì§€ë˜ë„ë¡ ë¶„ë¦¬
)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ”  (3) TF-IDF ë²¡í„° ë³€í™˜
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì´ë¯¸ ëŒ€í‘œê°ì • ëª¨ë¸ì—ì„œ í•™ìŠµí•œ vectorizerë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•¨ (fit() âŒ)
# â†’ ê°™ì€ ê¸°ì¤€ìœ¼ë¡œ ë¬¸ì íŠ¹ì§•ì„ ì¶”ì¶œí•´ì•¼ í•˜ë¯€ë¡œ ì¬ì‚¬ìš©ì´ ì¤‘ìš”í•¨
X_train_sub_tfidf = vectorizer.transform(X_train_sub)
X_test_sub_tfidf = vectorizer.transform(X_test_sub)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸŒ³ (4) ì„¸ë¶€ê°ì • ë¶„ë¥˜ ëª¨ë¸ ìƒì„± (ExtraTrees)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ExtraTreesClassifierëŠ” ëœë¤í¬ë ˆìŠ¤íŠ¸ì™€ ë¹„ìŠ·í•œ ì•™ìƒë¸” íŠ¸ë¦¬ ëª¨ë¸ë¡œ,
# í…ìŠ¤íŠ¸ ë¶„ë¥˜ì—ì„œë„ ë†’ì€ ì„±ëŠ¥ì„ ëƒ„
sub_et_model = ExtraTreesClassifier(
    n_estimators=674,        # ğŸ”½ íŠ¸ë¦¬ ê°œìˆ˜ 500 â†’ 400 (ì„±ëŠ¥ ê±°ì˜ ë™ì¼, ìš©ëŸ‰â†“)
    max_depth=None,            # ğŸ”¼ ì‚´ì§ ì—¬ìœ  (íŠ¸ë¦¬ ë³µì›ë ¥ ìœ ì§€)
    min_samples_split=2,
    min_samples_leaf=2,      # ğŸ”½ ë¦¬í”„ ìµœì†Œ ìƒ˜í”Œ ìˆ˜ ì™„í™” (íŠ¸ë¦¬ ê°œìˆ˜ëŠ” ìœ ì§€)
    max_features='sqrt',     # ğŸ”½ log2ë³´ë‹¤ ë‹¨ìˆœí•˜ê³  ë©”ëª¨ë¦¬ ì ˆì•½
    class_weight='balanced',
    n_jobs=-1,
    random_state=42,
    verbose=1
)


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ§  (5) ëª¨ë¸ í•™ìŠµ
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# TF-IDFë¡œ ë³€í™˜ëœ ë°ì´í„°ë¥¼ ì´ìš©í•´ ëª¨ë¸ì„ í•™ìŠµì‹œí‚´
sub_et_model.fit(X_train_sub_tfidf, y_train_sub)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ” (6) ëª¨ë¸ í‰ê°€ (ì •í™•ë„ ë° ë¦¬í¬íŠ¸)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ê°ì •ì„ ì˜ˆì¸¡í•˜ê³ , ì‹¤ì œ ì •ë‹µê³¼ ë¹„êµí•˜ì—¬ ì •í™•ë„ ê³„ì‚°
sub_pred = sub_et_model.predict(X_test_sub_tfidf)
sub_acc = accuracy_score(y_test_sub, sub_pred)

# ê²°ê³¼ ì¶œë ¥
print("\n[ì„¸ë¶€ê°ì • ëª¨ë¸ ê²°ê³¼]")
print(f"Test Accuracy: {sub_acc:.4f}")               # í…ŒìŠ¤íŠ¸ ì •í™•ë„ ì¶œë ¥
print(classification_report(y_test_sub, sub_pred))   # ê°ì •ë³„ ì •ë°€ë„, ì¬í˜„ìœ¨, F1-score ì¶œë ¥
print("=" * 60)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ğŸ’¾ (7) ëª¨ë¸ ë° ë²¡í„° ì €ì¥
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# í•™ìŠµëœ ì„¸ë¶€ê°ì • ëª¨ë¸ê³¼ ë²¡í„° ë³€í™˜ê¸°ë¥¼ íŒŒì¼ë¡œ ì €ì¥
# ì´ë ‡ê²Œ í•´ì•¼ Flaskë‚˜ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ì—ì„œ ë°”ë¡œ ë¶ˆëŸ¬ì™€ ì˜ˆì¸¡ ê°€ëŠ¥
pickle.dump(sub_et_model, open("C:/ai-project/moody-movie/models/emotion_sub_model.pkl", "wb"))
pickle.dump(vectorizer, open("C:/ai-project/moody-movie/models/sub_vectorizers.pkl", "wb"))